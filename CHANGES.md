# Changes (for v2.2?)
This is a list of any changes done to Magical Mary 1 since the last release. They will be included in the list of changes for the release when it happens.
## Bug-fixes
* Fixed a glitch where gliding with Mary's parasol when sticking to walls would prevent checking for walls behind her, allowing her to do things like turn around and jump toward the wall she's on, or worse, sliding up to the invisible ceiling of **any** area, then gliding to anywhere she wants!
* Added extra code to Mary's downward Air Dash to cancel it if she's ever detected gliding (with her Pretty Parasol), sliding on a wall, or bouncing off a spring. (The latter should stop the boost mid-way through, which will lessen how much the player could tweak where springs bounce them to.
* Fixed status bar's height in the depth map not matching its visual appearance.	
## Major
* If you slide up a wall and reach the top, you'll move back onto the ground, just like you would if you moved upward using a Ninja Coin in previous versions. It's more consistent and logical now; Going up? You will land on the higher ground.
* Sliding on walls (before wall-jumping) is now automatic, no need to be holding the "forward" key! This weird requirement was added years ago back in the World of Kirbycraft days because Mary would randomly think she hit a wall and would try sliding on thin air, but extra checks added since have rendered this safety feature unnecessary now. This makes doing downward Air Dashes to quickly slide down walls easier.
* Xane's flight now takes variable power away, factoring in his height off the ground, speed, and number of flaps. Basically, it's easier to fly straight up than trying to fly quickly across a wide-open area. (Doing that will cause you to make an emergency landing, so don't try it!) In addition, Xane's flight was nerfed; He doesn't get much height from flaps anymore, but instead now builds up speed quicker when flying in a straight line.
* The radio heard in City Street Run (1-3) has been revamped! Before, it only played music and randomly slapped togther a "talk show". After listening to real radio, I've improved the in-game radio, which now comes up with routines involving music playback, ad breaks, and the talk shows between them! (Talk shows in general are more detailed now, with a specific host and two guests, who can swap positions at random.)
* It might not be that major, but the radio (currently only in a test level) now is more detailed, with cover art for each song that hides during ads and animate upon switching songs. It's more modern and advanced than the old physical "blocks".
## Minor
* For you mod programmers, if there's any of you here, GetSpeed has been updated with new parameters to control what axises are factored in. It's not the same as GetActorVel# though, as this returns integers that usually are large at even slower speeds.
* Addititonally, the ***RoundTo5*** function is no longer in COMMON1.acs, instead in the common script file "mm1_extra.acs". It's also more freeform now, taking two arguments, one for the multiple to round to and a second one to pass your variable to.
* Running (moving fast in any way near the ground) no longer slowly regenerates your power. In fact, it does the opposite! Be careful with how much you run, as...moving your legs takes energy! Also, power can only be recovered if you're on the ground. Yeah, this sounds like a big downgrade but it both makes speed more "strategic" and discourages moving through the air to recover. Remember, Power Coins can still forcibly max out and freeze your power meter, and that if there's ever an item added that recovers power, it will work even in the air.
* Fog is now overall farther away from the player. GZDoom really loves to put the fog right in the player's face, but that doesn't work well with this game's open areas.
* Whoops! I didn't notice the game was calling itself "Mary's Magical Adventure" on the Windows title bar in v2.1, but it's now corrected.
* A new CVAR has been added, gl_spritedepth. Normally, GZDoom doesn't add sprites and transparent 3D floors (like water) to the depth buffer, but this causes odd visuals if using any Reshade shaders that use that map, such as depth haze (cough cough). If you use depth-based shaders (like the official "enhanced" preset), set this to TRUE. Over time, sprites that render as rectangles in this mode will be re-drawn to not use translucent pixels (such as cherry blossom petal clusters). This also improves sprite ordering when looking down at a column of them.
* Rewrote player footstep script to make footstep sound timing more dynamic (instead of a limited set of pre-defined speeds). There's even a forced step heard when you start moving instead of Mary silently moving for a split-second. In the future, this will also forcibly control Mary's walking/running animation, for more accuracy.
* Merged landing and footstep code into a single script. This won't be noticed during gameplay, but this "refactoring" of code simplifies it in a way.
* Greatly improved "bouncing" off of enemies. It's still hackish, but it's all handled in ACS now instead of relying on giving Mary an inventory item to hurt the enemy. Also, it appears to be more reliable and consistent, now working even if you land right on the top center of the enemy! Also, your bounce height off of enemies has been restored to be somewhat influenced by how quick you fall before hitting the enemy.
* Night ambience has been added in place of the unused "HCPD police station" ambience. It sounds creepy, with strange sounds and "owls", all over near-constant crickets. The main looping sound is actually entirely generated using AI. I hope OpenAI's artificial intelligence never becomes sentient and starts demanding I pay it royalties or something with how much I keep using its generated audio now...
* Fight Trap has finally been pre-rendered, so it's as loud as some of the other music in the game now. (Also, new AI-generated drum beats were added during the intro and siren "solo", as this is no longer meant for fighting the police (and hasn't been for a few versions now).
* New song added for the radio: "Arm Cannon Man"! (Is she referring to a certain blue fighting robot?)
* There's three new functions in mm1_extra.acs", the common "min", "max", and "clamp". They don't appear to function as intended, though.